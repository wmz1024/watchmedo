# å®æ—¶æ•°æ®å…¨é¢æ›´æ–°ä¿®å¤ ğŸ”„

## é—®é¢˜æè¿°

**åŸé—®é¢˜**: åˆ·æ–°æ—¶åªæœ‰"ç½‘ç»œæµé‡"å’Œ"æ­£åœ¨ä½¿ç”¨çš„åº”ç”¨"æ›´æ–°ï¼Œå…¶ä»–æ•°æ®ï¼ˆCPUã€å†…å­˜ã€ç”µæ± ã€åœ¨çº¿çŠ¶æ€ç­‰ï¼‰æ²¡æœ‰æ›´æ–°ã€‚

## ä¿®å¤å†…å®¹

### ä¿®å¤å‰ âŒ

```javascript
function renderRealtimeData(data) {
    // åªæ›´æ–°äº†ä¸¤ä¸ªéƒ¨åˆ†
    renderFocusedApp(data.processes);      âœ“ èšç„¦åº”ç”¨
    renderNetworkStats(data.network);      âœ“ ç½‘ç»œæµé‡
    // ç¼ºå°‘å…¶ä»–æ•°æ®çš„æ›´æ–° âœ—
}
```

### ä¿®å¤å âœ…

```javascript
function renderRealtimeData(data) {
    // å®Œæ•´æ›´æ–°æ‰€æœ‰å®æ—¶æ•°æ®
    updateSystemResources(data.stats, data.device);  âœ“ ç³»ç»Ÿèµ„æº
    renderFocusedApp(data.processes);                âœ“ èšç„¦åº”ç”¨
    renderNetworkStats(data.network);                âœ“ ç½‘ç»œæµé‡
}
```

## ç°åœ¨ä¼šå®æ—¶æ›´æ–°çš„æ•°æ®

### 1. è®¾å¤‡åŸºæœ¬ä¿¡æ¯ ğŸ–¥ï¸
- âœ… è®¡ç®—æœºåç§°
- âœ… åœ¨çº¿çŠ¶æ€ï¼ˆåœ¨çº¿/ç¦»çº¿ï¼‰
- âœ… æœ€åä¸ŠæŠ¥æ—¶é—´

### 2. ç³»ç»Ÿèµ„æº ğŸ’»
- âœ… CPUä½¿ç”¨ç‡ï¼ˆå®æ—¶ç™¾åˆ†æ¯”ï¼‰
- âœ… å†…å­˜ä½¿ç”¨ç‡ï¼ˆå®æ—¶ç™¾åˆ†æ¯”ï¼‰
- âœ… ç³»ç»Ÿè¿è¡Œæ—¶é—´

### 3. ç”µæ± ä¿¡æ¯ ğŸ”‹ (ç¬”è®°æœ¬)
- âœ… ç”µé‡ç™¾åˆ†æ¯”
- âœ… å……ç”µçŠ¶æ€
- âœ… ç”µæ± å›¾æ ‡å’Œé¢œè‰²

### 4. åº”ç”¨ä¿¡æ¯ ğŸ“±
- âœ… æ­£åœ¨èšç„¦çš„åº”ç”¨
- âœ… è¿ç»­åœç•™æ—¶é—´
- âœ… CPUå’Œå†…å­˜å ç”¨

### 5. ç½‘ç»œæµé‡ ğŸŒ
- âœ… ä¸Šä¼ /ä¸‹è½½æµé‡
- âœ… å„ç½‘å¡è¯¦æƒ…

## æŠ€æœ¯å®ç°

### åç«¯ API (stats.php)

#### ä¿®æ”¹1: æ·»åŠ è®¾å¤‡ä¿¡æ¯è¿”å›
```php
case 'realtime':
    // æ›´æ–°è®¾å¤‡åœ¨çº¿çŠ¶æ€
    updateDeviceOnlineStatus($db, $deviceId);
    
    // è·å–è®¾å¤‡ä¿¡æ¯
    $device = $db->fetchOne('SELECT * FROM devices WHERE id = ?', [$deviceId]);
    
    // è¿”å›è®¾å¤‡ä¿¡æ¯
    successResponse([
        'device' => [
            'id' => $device['id'],
            'name' => $device['name'],
            'computer_name' => $device['computer_name'],
            'is_online' => (bool)$device['is_online'],
            'last_seen_at' => $device['last_seen_at'],
            'last_seen_ago' => timeAgo($device['last_seen_at'])
        ],
        'stats' => $latestStats,
        // ...
    ]);
```

### å‰ç«¯ JavaScript (device.js)

#### æ–°å¢å‡½æ•°1: updateSystemResources
```javascript
function updateSystemResources(stats, deviceInfo) {
    // æ›´æ–°CPU
    document.getElementById('cpu-usage').textContent = 
        stats.cpu_usage_avg.toFixed(1) + '%';
    
    // æ›´æ–°å†…å­˜
    document.getElementById('memory-usage').textContent = 
        stats.memory_percent.toFixed(1) + '%';
    
    // æ›´æ–°è¿è¡Œæ—¶é—´
    document.getElementById('uptime').textContent = 
        formatUptime(stats.uptime);
    
    // æ›´æ–°ç”µæ± 
    renderBatteryInfo(stats);
    
    // æ›´æ–°è®¾å¤‡çŠ¶æ€
    if (deviceInfo) {
        updateDeviceStatus(deviceInfo);
    }
}
```

#### æ–°å¢å‡½æ•°2: updateDeviceStatus
```javascript
function updateDeviceStatus(device) {
    // æ›´æ–°è®¡ç®—æœºåç§°
    document.getElementById('computer-name').textContent = 
        device.computer_name;
    
    // æ›´æ–°åœ¨çº¿çŠ¶æ€
    if (device.is_online) {
        statusIndicator.className = '...bg-green-500 animate-pulse';
        statusText.textContent = 'åœ¨çº¿';
    } else {
        statusIndicator.className = '...bg-gray-400';
        statusText.textContent = 'ç¦»çº¿';
    }
    
    // æ›´æ–°æœ€åä¸ŠæŠ¥æ—¶é—´
    document.getElementById('last-seen').textContent = 
        device.last_seen_ago;
}
```

#### æ–°å¢å‡½æ•°3: timeAgoFromTimestamp
```javascript
function timeAgoFromTimestamp(timestamp) {
    const diffSecs = Math.floor((new Date() - new Date(timestamp)) / 1000);
    
    if (diffSecs < 60) return diffSecs + 'ç§’å‰';
    if (diffSecs < 3600) return Math.floor(diffSecs / 60) + 'åˆ†é’Ÿå‰';
    if (diffSecs < 86400) return Math.floor(diffSecs / 3600) + 'å°æ—¶å‰';
    return Math.floor(diffSecs / 86400) + 'å¤©å‰';
}
```

## åˆ·æ–°æœºåˆ¶å¯¹æ¯”

### ä¿®å¤å‰

| æ•°æ®é¡¹ | é¦–æ¬¡åŠ è½½ | è‡ªåŠ¨åˆ·æ–°(10ç§’) | æ‰‹åŠ¨åˆ·æ–° |
|-------|---------|---------------|---------|
| è®¾å¤‡ä¿¡æ¯ | âœ… | âŒ | âŒ |
| CPU/å†…å­˜ | âœ… | âŒ | âŒ |
| ç”µæ±  | âœ… | âŒ | âŒ |
| èšç„¦åº”ç”¨ | âœ… | âœ… | âœ… |
| ç½‘ç»œæµé‡ | âœ… | âœ… | âœ… |

### ä¿®å¤å

| æ•°æ®é¡¹ | é¦–æ¬¡åŠ è½½ | è‡ªåŠ¨åˆ·æ–°(10ç§’) | æ‰‹åŠ¨åˆ·æ–° |
|-------|---------|---------------|---------|
| è®¾å¤‡ä¿¡æ¯ | âœ… | âœ… | âœ… |
| CPU/å†…å­˜ | âœ… | âœ… | âœ… |
| ç”µæ±  | âœ… | âœ… | âœ… |
| èšç„¦åº”ç”¨ | âœ… | âœ… | âœ… |
| ç½‘ç»œæµé‡ | âœ… | âœ… | âœ… |

## æ•°æ®æµç¨‹

```
æ¯10ç§’è‡ªåŠ¨è§¦å‘ / ç”¨æˆ·ç‚¹å‡»åˆ·æ–°
            â†“
    loadRealtimeData()
            â†“
API: /api/stats.php?action=realtime&device_id=1
            â†“
è¿”å›æ•°æ®:
{
  "device": {
    "is_online": true,
    "last_seen_ago": "5ç§’å‰",
    "computer_name": "MY-PC"
  },
  "stats": {
    "cpu_usage_avg": 25.5,
    "memory_percent": 60.2,
    "uptime": 3600,
    "battery_percentage": 85.0
  },
  "processes": [...],
  "network": [...]
}
            â†“
    renderRealtimeData(data)
            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ updateSystemResources(stats, device)     â”‚
â”‚  â”œâ”€ CPUä½¿ç”¨ç‡      25.5%                 â”‚
â”‚  â”œâ”€ å†…å­˜ä½¿ç”¨ç‡     60.2%                 â”‚
â”‚  â”œâ”€ è¿è¡Œæ—¶é—´       1å°æ—¶                 â”‚
â”‚  â”œâ”€ ç”µæ± ç”µé‡       85% (å……ç”µä¸­)          â”‚
â”‚  â”œâ”€ åœ¨çº¿çŠ¶æ€       åœ¨çº¿ ğŸŸ¢               â”‚
â”‚  â””â”€ æœ€åä¸ŠæŠ¥       5ç§’å‰                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ renderFocusedApp(processes)              â”‚
â”‚  â”œâ”€ åº”ç”¨åç§°       Chrome                â”‚
â”‚  â”œâ”€ çª—å£æ ‡é¢˜       GitHub                â”‚
â”‚  â””â”€ è¿ç»­åœç•™       5åˆ†é’Ÿ 30ç§’            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ renderNetworkStats(network)              â”‚
â”‚  â”œâ”€ ä¸‹è½½æµé‡       1.5 MB                â”‚
â”‚  â””â”€ ä¸Šä¼ æµé‡       500 KB                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## æ›´æ–°é¢‘ç‡

### è‡ªåŠ¨åˆ·æ–°ï¼ˆæ¯10ç§’ï¼‰
æ‰€æœ‰å®æ—¶æ•°æ®éƒ½ä¼šè‡ªåŠ¨æ›´æ–°ï¼š
- CPUä½¿ç”¨ç‡
- å†…å­˜ä½¿ç”¨ç‡  
- è¿è¡Œæ—¶é—´
- ç”µæ± ç”µé‡
- åœ¨çº¿çŠ¶æ€
- æœ€åä¸ŠæŠ¥æ—¶é—´
- èšç„¦åº”ç”¨
- è¿ç»­åœç•™æ—¶é—´
- ç½‘ç»œæµé‡

### æ‰‹åŠ¨åˆ·æ–°ï¼ˆç‚¹å‡»æŒ‰é’®ï¼‰
ç«‹å³åˆ·æ–°æ‰€æœ‰æ•°æ®ï¼š
- å®æ—¶æ•°æ®ï¼ˆå¦‚ä¸Šï¼‰
- ç»Ÿè®¡æ•°æ®ï¼ˆå›¾è¡¨ã€åº”ç”¨åˆ—è¡¨ç­‰ï¼‰

### è§†å›¾åˆ‡æ¢
åˆ‡æ¢æ—¥/æœˆ/å¹´è§†å›¾æ—¶ï¼š
- ç»Ÿè®¡æ•°æ®ï¼ˆé€‚åº”æ–°çš„æ—¶é—´èŒƒå›´ï¼‰
- å®æ—¶æ•°æ®ï¼ˆæœ€æ–°çŠ¶æ€ï¼‰

## ç”¨æˆ·ä½“éªŒæ”¹è¿›

### 1. å®æ—¶æ„Ÿ âš¡
```
10ç§’å‰: CPU 20%, å†…å­˜ 50%, ç”µæ±  85%
ç°åœ¨:   CPU 25%, å†…å­˜ 60%, ç”µæ±  84% â† æ‰€æœ‰æ•°æ®éƒ½æ›´æ–°äº†ï¼
```

### 2. ä¸€è‡´æ€§ ğŸ¯
```
ç‚¹å‡»åˆ·æ–° â†’ æ•´ä¸ªé¡µé¢çš„æ‰€æœ‰åŠ¨æ€æ•°æ®éƒ½åŒæ­¥æ›´æ–°
ä¸ä¼šå‡ºç°éƒ¨åˆ†æ›´æ–°ã€éƒ¨åˆ†é™ˆæ—§çš„æƒ…å†µ
```

### 3. å“åº”æ€§ ğŸ“±
```
åœ¨çº¿çŠ¶æ€å˜åŒ–: åœ¨çº¿ â†’ ç¦»çº¿ (ç«‹å³åæ˜ )
CPUæ³¢åŠ¨: å®æ—¶æ˜¾ç¤º
ç”µæ± ç”µé‡: å®æ—¶æ˜¾ç¤º
```

## æµ‹è¯•æ–¹æ³•

### æµ‹è¯•1: è‡ªåŠ¨åˆ·æ–°
```
1. æ‰“å¼€è®¾å¤‡è¯¦æƒ…é¡µé¢
2. è§‚å¯ŸCPU/å†…å­˜æ•°å€¼
3. ç­‰å¾…10ç§’
4. æŸ¥çœ‹å€’è®¡æ—¶å½’é›¶æ—¶ï¼Œæ‰€æœ‰æ•°å€¼æ˜¯å¦æ›´æ–°
```

### æµ‹è¯•2: æ‰‹åŠ¨åˆ·æ–°
```
1. ç‚¹å‡»åˆ·æ–°æŒ‰é’®
2. è§‚å¯Ÿä»¥ä¸‹å†…å®¹æ˜¯å¦éƒ½æ›´æ–°ï¼š
   âœ“ CPUä½¿ç”¨ç‡
   âœ“ å†…å­˜ä½¿ç”¨ç‡
   âœ“ è¿è¡Œæ—¶é—´
   âœ“ ç”µæ± ç”µé‡
   âœ“ åœ¨çº¿çŠ¶æ€
   âœ“ æœ€åä¸ŠæŠ¥æ—¶é—´
   âœ“ èšç„¦åº”ç”¨
   âœ“ ç½‘ç»œæµé‡
```

### æµ‹è¯•3: åˆ‡æ¢è§†å›¾
```
1. åˆ‡æ¢åˆ°æœˆè§†å›¾
2. éªŒè¯å®æ—¶æ•°æ®ä¹Ÿæ›´æ–°äº†
3. åˆ‡æ¢å›æ—¥è§†å›¾
4. å†æ¬¡éªŒè¯
```

## æµè§ˆå™¨æ§åˆ¶å°éªŒè¯

æ‰“å¼€ F12 â†’ Consoleï¼Œå¯ä»¥çœ‹åˆ°ï¼š

```
å®æ—¶æ•°æ®å“åº”: {
  device: {is_online: true, last_seen_ago: "5ç§’å‰", ...},
  stats: {cpu_usage_avg: 25.5, memory_percent: 60.2, ...},
  processes: [...],
  network: [...]
}

æ¸²æŸ“å®æ—¶æ•°æ®: {...}
æ›´æ–°CPU: 25.5%
æ›´æ–°å†…å­˜: 60.2%
æ›´æ–°ç”µæ± : 85%
æ›´æ–°åœ¨çº¿çŠ¶æ€: åœ¨çº¿
```

## æ€§èƒ½å½±å“

### APIå“åº”
```
å“åº”å¤§å°: ~5-10KB (åŒ…å«æ‰€æœ‰å®æ—¶æ•°æ®)
å“åº”æ—¶é—´: 50-200ms
æ›´æ–°é¢‘ç‡: æ¯10ç§’
æ•°æ®åº“æŸ¥è¯¢: 5-6æ¬¡ï¼ˆå·²ä¼˜åŒ–ï¼‰
```

### å‰ç«¯æ¸²æŸ“
```
DOMæ›´æ–°: 10-15ä¸ªå…ƒç´ 
æ¸²æŸ“æ—¶é—´: <10ms
æ— é—ªçƒã€å¹³æ»‘æ›´æ–°
```

## ç›¸å…³æ–‡ä»¶

### ä¿®æ”¹çš„æ–‡ä»¶
1. âœ… `client/api/stats.php` - APIè¿”å›è®¾å¤‡ä¿¡æ¯
2. âœ… `client/public/assets/js/device.js` - å®Œæ•´çš„æ›´æ–°é€»è¾‘

### æ–°å¢å‡½æ•°
- `updateSystemResources()` - æ›´æ–°ç³»ç»Ÿèµ„æº
- `updateDeviceStatus()` - æ›´æ–°è®¾å¤‡çŠ¶æ€
- `timeAgoFromTimestamp()` - è®¡ç®—æ—¶é—´å·®

## æ€»ç»“

ç°åœ¨æ¯10ç§’è‡ªåŠ¨åˆ·æ–°æˆ–æ‰‹åŠ¨åˆ·æ–°æ—¶ï¼Œæ‰€æœ‰åŠ¨æ€æ•°æ®éƒ½ä¼šåŒæ­¥æ›´æ–°ï¼š

- âœ… **è®¾å¤‡ä¿¡æ¯**: åœ¨çº¿çŠ¶æ€ã€æœ€åä¸ŠæŠ¥
- âœ… **ç³»ç»Ÿèµ„æº**: CPUã€å†…å­˜ã€è¿è¡Œæ—¶é—´
- âœ… **ç”µæ± çŠ¶æ€**: ç”µé‡ã€å……ç”µçŠ¶æ€ï¼ˆç¬”è®°æœ¬ï¼‰
- âœ… **èšç„¦åº”ç”¨**: å½“å‰ä½¿ç”¨çš„åº”ç”¨ã€åœç•™æ—¶é—´
- âœ… **ç½‘ç»œæµé‡**: ä¸Šä¼ ã€ä¸‹è½½æµé‡

ç”¨æˆ·ç°åœ¨å¯ä»¥çœ‹åˆ°çœŸæ­£å®æ—¶çš„è®¾å¤‡çŠ¶æ€ï¼ğŸ‰

