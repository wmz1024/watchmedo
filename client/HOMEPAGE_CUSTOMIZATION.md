# 首页定制功能 🏠

## 功能概述

在首页添加可自定义的标题和简介，以及多设备数据统计预览，提供全局监控视图。

## 新增功能

### 1. 可配置的首页标题和简介 📝

#### 后台配置
```
管理后台 → 系统设置 → 首页配置
- 首页标题: "设备监控中心"
- 首页简介: "实时监控您的设备运行状态，追踪应用使用情况"
```

#### 前端显示
```
┌─────────────────────────────────────────┐
│          设备监控中心                    │ ← 可配置标题
│                                         │
│  实时监控您的设备运行状态，              │ ← 可配置简介
│      追踪应用使用情况                    │
└─────────────────────────────────────────┘
```

### 2. 多设备统计概览 📊

#### 四个统计卡片

1. **总设备数** 🖥️
   - 图标：电脑图标（蓝色）
   - 显示：所有设备数量

2. **在线设备** ✅
   - 图标：对号图标（绿色）
   - 显示：当前在线的设备数

3. **平均CPU使用率** ⚡
   - 图标：闪电图标（紫色）
   - 显示：所有在线设备的平均CPU使用率

4. **平均内存使用率** 📦
   - 图标：内存图标（橙色）
   - 显示：所有在线设备的平均内存使用率

### 3. 增强的设备卡片预览 💳

每个设备卡片显示：
- ✅ 设备名称
- ✅ 计算机名称
- ✅ 在线/离线状态（带动画）
- ✅ CPU使用率
- ✅ 内存使用率
- ✅ 运行时间
- ✅ 最后上报时间

## 界面展示

### 完整首页布局

```
┌───────────────────────────────────────────────┐
│ Watch Me Do  设备监控系统        管理后台      │
└───────────────────────────────────────────────┘

┌───────────────────────────────────────────────┐
│              设备监控中心                      │
│                                               │
│    实时监控您的设备运行状态，追踪应用使用情况   │
└───────────────────────────────────────────────┘

┌──────────┬──────────┬──────────┬──────────┐
│ 🖥️       │ ✅       │ ⚡       │ 📦       │
│ 总设备数  │ 在线设备  │ 平均CPU  │ 平均内存  │
│   5      │   3      │  25.5%   │  60.2%   │
└──────────┴──────────┴──────────┴──────────┘

┌─────────────────────────────────────────────┐
│ 设备列表     共 5 台设备，3 台在线           │
├─────────────────────────────────────────────┤
│ ┌────────────┬────────────┬────────────┐   │
│ │ 办公电脑    │ 家用笔记本  │ 服务器      │   │
│ │ OFFICE-PC  │ HOME       │ SERVER     │   │
│ │ 🟢 在线    │ 🟢 在线    │ ⚫ 离线    │   │
│ │ CPU: 25%   │ CPU: 30%   │ CPU: -     │   │
│ │ 内存: 60%  │ 内存: 55%  │ 内存: -    │   │
│ │ 运行: 5时  │ 运行: 3天  │ 运行: -    │   │
│ │ 2分钟前    │ 5秒前      │ 2天前      │   │
│ └────────────┴────────────┴────────────┘   │
└─────────────────────────────────────────────┘
```

## 数据统计逻辑

### 总设备数
```javascript
totalDevices = devices.length
```

### 在线设备
```javascript
onlineDevices = devices.filter(d => d.is_online).length
```

### 平均CPU使用率
```javascript
// 只计算在线设备的平均值
onlineDevices = devices.filter(d => d.is_online && d.latest_stats)
totalCpu = sum(onlineDevices.map(d => d.latest_stats.cpu_usage_avg))
avgCpu = totalCpu / onlineDevices.length
```

### 平均内存使用率
```javascript
// 只计算在线设备的平均值
totalMemory = sum(onlineDevices.map(d => d.latest_stats.memory_percent))
avgMemory = totalMemory / onlineDevices.length
```

## 配置步骤

### 步骤1: 登录管理后台
```
访问: http://your-domain/client/admin/
```

### 步骤2: 进入系统设置
```
管理后台 → 系统设置标签
```

### 步骤3: 配置首页
```
首页配置:
- 首页标题: 输入自定义标题
- 首页简介: 输入自定义描述文字
```

### 步骤4: 保存并预览
```
点击"保存首页配置"
→ 打开首页查看效果
```

## 配置示例

### 示例1: 企业内部监控
```
标题: "IT设备监控平台"
简介: "实时监控公司所有办公设备运行状态，确保工作效率"
```

### 示例2: 个人设备管理
```
标题: "我的设备中心"
简介: "统一管理家中所有电脑和笔记本，随时掌握运行情况"
```

### 示例3: 实验室监控
```
标题: "实验室设备监控系统"
简介: "24小时监控实验室设备状态，记录计算任务执行情况"
```

## API接口

### 1. 获取首页配置（公开）
```
GET /api/settings.php?action=homepage

响应:
{
  "success": true,
  "data": {
    "title": "设备监控中心",
    "description": "实时监控您的设备运行状态，追踪应用使用情况"
  }
}
```

### 2. 保存首页配置（需登录）
```
POST /api/admin.php?action=save_settings

请求体:
{
  "homepage_title": "设备监控中心",
  "homepage_description": "实时监控您的设备运行状态，追踪应用使用情况"
}
```

## 技术实现

### 前端 (index.php + main.js)

#### 1. HTML结构
```html
<!-- 首页标题和简介 -->
<div id="page-header">
    <h1 id="page-title">设备监控中心</h1>
    <p id="page-description">简介文字</p>
</div>

<!-- 统计概览 -->
<div id="stats-overview">
    <div>总设备数: <span id="total-devices">5</span></div>
    <div>在线设备: <span id="online-devices">3</span></div>
    <div>平均CPU: <span id="avg-cpu">25.5%</span></div>
    <div>平均内存: <span id="avg-memory">60.2%</span></div>
</div>
```

#### 2. JavaScript加载
```javascript
// 加载首页配置
async function loadHomePageConfig() {
    const response = await fetch('../api/settings.php?action=homepage');
    const config = await response.json();
    
    document.getElementById('page-title').textContent = config.title;
    document.getElementById('page-description').textContent = config.description;
}

// 计算统计数据
function renderDevices() {
    // 计算总设备、在线设备、平均CPU、平均内存
    // 更新统计卡片
}
```

### 后端 (PHP)

#### 数据库存储
```
settings表:
- homepage_title: "设备监控中心"
- homepage_description: "实时监控您的设备运行状态..."
```

#### API实现
```php
// settings.php - 公开API
case 'homepage':
    $config = [
        'title' => getSetting($db, 'homepage_title', '...'),
        'description' => getSetting($db, 'homepage_description', '...')
    ];
    successResponse($config);

// admin.php - 管理API
case 'save_settings':
    setSetting($db, 'homepage_title', $data['homepage_title']);
    setSetting($db, 'homepage_description', $data['homepage_description']);
```

## 统计概览卡片设计

### 颜色方案
| 卡片 | 主色 | 用途 |
|------|------|------|
| 总设备数 | 蓝色 (#3B82F6) | 信息 |
| 在线设备 | 绿色 (#10B981) | 成功/健康 |
| 平均CPU | 紫色 (#9333EA) | 性能 |
| 平均内存 | 橙色 (#F59E0B) | 资源 |

### 图标说明
- 总设备: 电脑屏幕图标
- 在线设备: 圆圈对号图标
- CPU: 闪电图标
- 内存: 立方体图标

## 响应式设计

### 大屏幕 (≥1024px)
```
统计卡片: 4列横排
设备卡片: 3列网格
```

### 中等屏幕 (768px-1024px)
```
统计卡片: 4列横排（可能略窄）
设备卡片: 2列网格
```

### 小屏幕 (<768px)
```
统计卡片: 1列纵排
设备卡片: 1列纵排
```

## 数据更新频率

### 统计概览
- 首次加载：立即显示
- 自动刷新：每30秒
- 手动刷新：刷新页面

### 首页配置
- 首次加载：立即获取
- 修改后：刷新页面生效

## 使用场景

### 场景1: 企业监控中心
```
标题: "IT运维监控平台"
简介: "监控全公司200+台设备，实时掌握运行状况"

统计显示:
- 总设备: 245台
- 在线: 198台
- 平均CPU: 15.2%
- 平均内存: 45.8%
```

### 场景2: 家庭设备管理
```
标题: "家庭设备中心"
简介: "管理所有家用电脑，了解家人的电脑使用情况"

统计显示:
- 总设备: 4台
- 在线: 3台
- 平均CPU: 20.5%
- 平均内存: 55.0%
```

### 场景3: 开发团队监控
```
标题: "开发环境监控"
简介: "监控开发服务器和开发机器的资源使用"

统计显示:
- 总设备: 15台
- 在线: 12台
- 平均CPU: 65.3% (编译任务)
- 平均内存: 78.5%
```

## 优势

### 1. 品牌定制 🎨
- 自定义标题突出品牌
- 自定义简介说明用途
- 提升专业形象

### 2. 全局视图 👁️
- 一眼看到所有设备概况
- 快速识别问题设备
- 掌握整体资源使用

### 3. 数据预览 📋
- 设备卡片显示关键指标
- 无需进入详情即可查看
- 快速对比多台设备

## 相关文件

### 新增功能
1. `client/api/settings.php` - 添加homepage配置API
2. `client/public/index.php` - 首页标题、简介和统计卡片
3. `client/public/assets/js/main.js` - 加载配置和计算统计

### 修改文件
1. `client/admin/index.php` - 首页配置界面
2. `client/api/admin.php` - 保存/读取配置

### 数据库
```
settings表新增:
- homepage_title
- homepage_description
```

## 测试方法

### 测试1: 配置保存
```
1. 登录管理后台
2. 系统设置 → 首页配置
3. 修改标题和简介
4. 保存
5. 刷新首页查看效果
```

### 测试2: 统计数据
```
1. 确保有多台设备
2. 部分设备在线
3. 查看统计卡片数据是否正确：
   - 总设备数 = 所有设备
   - 在线设备 = 在线的设备
   - 平均CPU = 在线设备的平均值
   - 平均内存 = 在线设备的平均值
```

### 测试3: 自动刷新
```
1. 打开首页
2. 等待30秒
3. 查看统计数据是否更新
4. 设备状态是否更新
```

## 最佳实践

### 标题建议
```
✅ 简洁明了：6-12个字
✅ 突出用途：监控、管理、中心
✅ 品牌化：加入组织名称

示例：
- "XXX公司设备监控"
- "IT运维监控平台"
- "智能设备管理中心"
```

### 简介建议
```
✅ 说明功能：监控什么、做什么
✅ 控制长度：30-50个字
✅ 易于理解：使用简单语言

示例：
- "实时监控所有办公设备，追踪应用使用和系统资源"
- "统一管理多台电脑，随时了解运行状态和使用情况"
- "7x24小时监控实验室设备，记录计算任务执行过程"
```

## 总结

首页定制功能提供了：

### 配置灵活性
- ✅ 自定义标题
- ✅ 自定义简介
- ✅ 后台即时生效

### 数据展示
- ✅ 4个统计卡片
- ✅ 实时数据预览
- ✅ 多设备对比

### 用户体验
- ✅ 清晰的信息层级
- ✅ 直观的数据呈现
- ✅ 美观的视觉设计

现在首页不仅功能强大，而且可以根据需求自定义，展现独特的品牌形象！🏠✨

